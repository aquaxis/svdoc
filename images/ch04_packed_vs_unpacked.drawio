<mxfile host="app.diagrams.net" modified="2026-02-15" agent="draw.io" type="device">
  <diagram id="ch04_packed_vs_unpacked" name="パックド配列とアンパックド配列のメモリレイアウト比較">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <!-- タイトル -->
        <mxCell id="2" value="パックド配列 vs アンパックド配列 — メモリレイアウト比較" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=18;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="250" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- ========== パックド配列セクション ========== -->
        <mxCell id="3" value="パックド配列（Packed Array）" style="text;html=1;fontSize=16;fontStyle=1;align=center;fontColor=#1a5276;" vertex="1" parent="1">
          <mxGeometry x="80" y="75" width="400" height="30" as="geometry" />
        </mxCell>
        <!-- 宣言コード -->
        <mxCell id="4" value="&lt;font face=&quot;monospace&quot;&gt;logic [3:0][7:0] packed_data;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;fillColor=#f5f5f5;strokeColor=#cccccc;rounded=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="80" y="110" width="350" height="30" as="geometry" />
        </mxCell>
        <!-- 背景枠 -->
        <mxCell id="5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;dashed=1;opacity=30;" vertex="1" parent="1">
          <mxGeometry x="40" y="150" width="470" height="340" as="geometry" />
        </mxCell>
        <!-- メモリ説明 -->
        <mxCell id="6" value="&lt;b&gt;連続したビットベクタ（32ビット）&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;strokeColor=none;fillColor=none;fontSize=12;fontColor=#1a5276;" vertex="1" parent="1">
          <mxGeometry x="100" y="160" width="300" height="25" as="geometry" />
        </mxCell>
        <!-- ビットブロック全体 -->
        <mxCell id="7" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#6c8ebf;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="195" width="400" height="60" as="geometry" />
        </mxCell>
        <!-- [3] -->
        <mxCell id="8" value="[3]&lt;br&gt;ビット 31:24" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="195" width="100" height="60" as="geometry" />
        </mxCell>
        <!-- [2] -->
        <mxCell id="9" value="[2]&lt;br&gt;ビット 23:16" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b6d7f2;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="180" y="195" width="100" height="60" as="geometry" />
        </mxCell>
        <!-- [1] -->
        <mxCell id="10" value="[1]&lt;br&gt;ビット 15:8" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="280" y="195" width="100" height="60" as="geometry" />
        </mxCell>
        <!-- [0] -->
        <mxCell id="11" value="[0]&lt;br&gt;ビット 7:0" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b6d7f2;strokeColor=#6c8ebf;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="380" y="195" width="100" height="60" as="geometry" />
        </mxCell>
        <!-- MSB/LSBラベル -->
        <mxCell id="12" value="MSB" style="text;html=1;align=center;fontSize=10;fontColor=#999999;" vertex="1" parent="1">
          <mxGeometry x="80" y="260" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="13" value="LSB" style="text;html=1;align=center;fontSize=10;fontColor=#999999;" vertex="1" parent="1">
          <mxGeometry x="440" y="260" width="40" height="20" as="geometry" />
        </mxCell>
        <!-- 特徴ボックス -->
        <mxCell id="14" value="✔ 全ビットが連続メモリに配置&lt;br&gt;✔ ビット演算・スライスが可能&lt;br&gt;✔ ポート接続にそのまま使用可能&lt;br&gt;✔ 合成可能（ハードウェアに直接対応）" style="text;html=1;align=left;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="300" width="350" height="80" as="geometry" />
        </mxCell>
        <!-- ビットスライスの例 -->
        <mxCell id="15" value="&lt;font face=&quot;monospace&quot;&gt;packed_data[1] = 8'hFF;&lt;br&gt;packed_data[2][3:0] = 4'b1010;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=#d79b00;rounded=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="395" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="16" value="ビット単位でアクセス可能" style="text;html=1;align=center;fontSize=10;fontColor=#d79b00;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="440" width="200" height="20" as="geometry" />
        </mxCell>

        <!-- ========== アンパックド配列セクション ========== -->
        <mxCell id="20" value="アンパックド配列（Unpacked Array）" style="text;html=1;fontSize=16;fontStyle=1;align=center;fontColor=#1a5276;" vertex="1" parent="1">
          <mxGeometry x="700" y="75" width="400" height="30" as="geometry" />
        </mxCell>
        <!-- 宣言コード -->
        <mxCell id="21" value="&lt;font face=&quot;monospace&quot;&gt;logic [7:0] unpacked_data [4];&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;fillColor=#f5f5f5;strokeColor=#cccccc;rounded=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="700" y="110" width="350" height="30" as="geometry" />
        </mxCell>
        <!-- 背景枠 -->
        <mxCell id="22" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;dashed=1;opacity=30;" vertex="1" parent="1">
          <mxGeometry x="640" y="150" width="470" height="340" as="geometry" />
        </mxCell>
        <!-- メモリ説明 -->
        <mxCell id="23" value="&lt;b&gt;個別のメモリ領域（各8ビット+パディング）&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;strokeColor=none;fillColor=none;fontSize=12;fontColor=#1a5276;" vertex="1" parent="1">
          <mxGeometry x="700" y="160" width="340" height="25" as="geometry" />
        </mxCell>
        <!-- 各要素 -->
        <mxCell id="24" value="[0] : 8ビット" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="720" y="195" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="25" value="padding" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#cccccc;fontSize=10;fontColor=#999999;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="880" y="195" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="26" value="[1] : 8ビット" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="720" y="245" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="27" value="padding" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#cccccc;fontSize=10;fontColor=#999999;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="880" y="245" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="28" value="[2] : 8ビット" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="720" y="295" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="29" value="padding" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#cccccc;fontSize=10;fontColor=#999999;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="880" y="295" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="30" value="[3] : 8ビット" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="720" y="345" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="31" value="padding" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#cccccc;fontSize=10;fontColor=#999999;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="880" y="345" width="80" height="40" as="geometry" />
        </mxCell>
        <!-- 特徴ボックス -->
        <mxCell id="32" value="✔ 各要素が独立したメモリ領域&lt;br&gt;✔ 要素単位のアクセス&lt;br&gt;✘ ビットスライス不可&lt;br&gt;✘ 要素間にパディングの可能性" style="text;html=1;align=left;verticalAlign=top;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="400" width="320" height="80" as="geometry" />
        </mxCell>

        <!-- ========== 中央の比較矢印 ========== -->
        <mxCell id="40" value="&lt;b&gt;vs&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;fontSize=24;fontColor=#FF6600;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="530" y="210" width="60" height="40" as="geometry" />
        </mxCell>
        <!-- 下部サマリ -->
        <mxCell id="41" value="&lt;b&gt;使い分けの指針&lt;/b&gt;：パックド→ビット操作・ポート接続　|　アンパックド→メモリ配列・テストベンチ" style="text;html=1;align=center;verticalAlign=middle;fillColor=#E8EAF6;strokeColor=#7986CB;rounded=1;fontSize=12;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="200" y="510" width="700" height="35" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
